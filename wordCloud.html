<html>
<head>
  <script src = "js/wordcloud2.js"></script>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <script>
    var img = new Image(2340,1332);
    img.src = 'assets/valparaiso.png';

    img.onload = function(){
      var canvas = document.getElementById('my_canvas');
      var ctx = canvas.getContext('2d');
      // ctx.drawImage(img,0,0);
      //
      // ctx.globalCompositeOperation = 'source-in';

      socket.on('update',onUpdate);
    }

    var socket = io('/screen-game');
    var colorList = ['#68b5ff','#97f9fc','#f9f9ff'];
    var onUpdate = function(msg){
      var canvas = document.getElementById('my_canvas');
      var wordlist = msg.wordSea;
      var currentList = msg.index;
      console.log(wordlist.length);
      console.log (wordlist);
      WordCloud(canvas, {
        list: wordlist,
        drawOutOfBound:false,
        color: function(word, weight){
           var i = Math.floor(Math.random()*colorList.length);
           return colorList[i];
         },
         gridSize: 32,
         origin: [canvas.width/4,canvas.height/2],
         shape: function(theta) {
           var max = 1152;
            var leng = [229,227,225,223,221,220,217,215,213,211,210,209,207,200,186,173,163,153,145,137,130,124,119,114,109,105,101,97,94,90,87,85,82,80,77,75,73,71,70,68,66,65,63,62,61,59,58,57,56,55,54,53,52,51,50,49,48,50,47,46,46,45,44,45,43,42,42,41,42,40,41,39,40,38,38,39,37,38,36,39,36,35,36,36,34,35,34,36,33,34,34,32,32,33,34,31,32,33,31,33,30,31,31,30,32,29,30,30,31,29,31,30,28,29,30,28,29,31,30,28,28,27,28,29,29,27,28,29,30,27,28,26,27,28,29,26,27,28,29,26,27,28,29,26,27,28,26,27,28,29,26,27,28,29,26,27,28,29,26,27,28,26,27,28,28,26,27,29,27,26,28,28,26,27,29,28,26,27,28,27,26,29,28,27,26,29,28,27,29,28,27,30,29,28,27,29,28,30,31,29,28,30,29,29,30,31,29,31,30,30,31,32,30,32,31,32,33,31,33,32,33,34,34,32,33,35,34,34,35,34,36,35,36,36,37,36,38,37,38,39,40,38,39,40,41,41,42,42,43,42,43,44,45,46,47,46,47,48,49,50,51,52,53,53,54,55,56,57,58,59,60,62,63,64,66,68,69,71,73,75,77,79,82,84,87,90,93,96,100,104,108,113,118,123,129,136,143,152,161,172,184,198,214,233,256,284,319,363,422,504,625,823,1135,1152,0,897,871,850,830,827,824,822,776,768,760,752,745,737,732,727,722,717,706,691,681,676,674,405,397,388,379,374,366,359,353,345,340,334,328,321,317,312,308,303,299,294,289,285,282,279,274,271,267,265,261,258,255,252,249,247,244,241,239,236,235,233,231];

            return leng[(theta / (2 * Math.PI)) * leng.length | 0] / max;
          },
         rotateRatio: 0.5,
         rotationSteps: 2,
         backgroundColor: '#020066'
       });
    };
  </script>
  <canvas id='my_canvas'  width="2340" height="1332"></canvas>
</body>
</html>
